<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drink Recipe Quiz - Click Ingredients</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 20px auto;
      padding: 10px;
    }
    h1 {
      text-align: center;
    }
    #ingredients-list {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 10px 0;
    }
    .ingredient-btn {
      padding: 6px 12px;
      border: 1.5px solid #444;
      border-radius: 16px;
      background: #eee;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s, border-color 0.3s;
    }
    .ingredient-btn.selected {
      background-color: #4caf50;
      color: white;
      border-color: #4caf50;
    }
    #cup {
      border: 2px dashed #666;
      min-height: 50px;
      padding: 8px;
      margin: 12px 0;
      border-radius: 8px;
      background-color: #f9f9f9;
    }
    #cup strong {
      display: block;
      margin-bottom: 6px;
    }
    #result {
      margin-top: 16px;
      font-weight: bold;
      min-height: 24px;
    }
    #score {
      margin-top: 12px;
      font-size: 1.1em;
    }
    #submit-btn {
      padding: 8px 18px;
      font-size: 1em;
      margin-top: 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h1>Drink Recipe Quiz</h1>
<p>Click on the ingredients that belong to the drink.</p>

<div>
  <p><strong id="drink-name"></strong></p>
  <div id="ingredients-list"></div>

  <div id="cup"><strong>Selected Ingredients:</strong><div id="selected-ingredients"></div></div>

  <button id="submit-btn">Submit</button>
  <div id="result"></div>
  <div id="score"></div>
</div>

<script>
const recipes = {
  "Cold Tea Basic": ["200 Tea", "+S/ Syrup", "+100 HW"],
  "Hot Tea Basic": ["200 Tea", "+S/ Syrup", "+200 HW"],
  "Cold Milk Tea Basic": ["S", "3 creamer", "HW up to 100", "+250 Tea"],
  "Hot Milk Tea Basic": ["S", "3 creamer", "+250 Tea"],
  "Mango Tea": ["Mango 40", "Passion 40", "+25% S"],
  "Mad Hatter GT": ["Peppermint 20", "Lemon 20", "+25% S"],
  "Lemon Honey GT": ["40 Honey", "4 slices Lemon", "+25% S", "100 HW"],
  "HK Lemon Tea": ["S", "4 slices lemon", "up to 350 water", "150 HK tea"],
  "HK Milk Tea Cold": ["40 Conden", "60 Evapo", "300 Tea", "COLD 60 conden"],
  "HK Milk Tea Hot": ["40 Conden", "60 Evapo", "150 Tea", "150 coffee", "COLD 60 conden"],
  "Thai MT": ["300 T", "100 HH", "Syrup 40", "MT No S"],
  "Taro Milk": ["TARO to 250 HW"],
  "Caramel MT": ["3 creamer", "HW", "Caramel 60 +25% S", "200 BT"],
  "Yakult Rose Lemon": ["Rose 25", "Lemon 15", "Yakult 40", "CW up to 400"],
  "Yakult Peach": ["Peach 60", "Yakult 40", "CW to 300", "butterfly pea"],
  "Slush Basic": ["All syrup 70", "No S", "+50 HW"],
  "Shaved Ice Red Bean": ["White Rabbit base", "4 creamer", "50 HW", "80 HH", "blend"],
  "Iced Milk Coffee": ["150 Hot Coffee", "inc S", "4 creamer", "250 Cold Coffee"],
  "Iced Black Coffee": ["150 Hot Coffee", "inc S", "250 Cold Coffee"]
};

// Flatten all unique ingredients
const allIngredients = Array.from(
  new Set(
    Object.values(recipes).flat()
  )
).sort();

const drinks = Object.keys(recipes);
const rounds = 5;

let currentRound = 0;
let score = 0;
let currentDrink = null;
let selectedIngredients = new Set();

const drinkNameEl = document.getElementById("drink-name");
const ingredientsListEl = document.getElementById("ingredients-list");
const selectedIngredientsEl = document.getElementById("selected-ingredients");
const submitBtn = document.getElementById("submit-btn");
const resultEl = document.getElementById("result");
const scoreEl = document.getElementById("score");

function renderIngredients() {
  ingredientsListEl.innerHTML = "";
  allIngredients.forEach(ingredient => {
    const btn = document.createElement("button");
    btn.textContent = ingredient;
    btn.className = "ingredient-btn";
    btn.addEventListener("click", () => {
      if (selectedIngredients.has(ingredient)) {
        selectedIngredients.delete(ingredient);
        btn.classList.remove("selected");
      } else {
        selectedIngredients.add(ingredient);
        btn.classList.add("selected");
      }
      updateCup();
    });
    ingredientsListEl.appendChild(btn);
  });
}

function updateCup() {
  selectedIngredientsEl.textContent = [...selectedIngredients].join(", ") || "(none)";
}

function normalizeList(list) {
  return list.map(s => s.trim().toLowerCase()).sort();
}

function startGame() {
  currentRound = 0;
  score = 0;
  scoreEl.textContent = `Score: ${score} / ${rounds}`;
  resultEl.textContent = "";
  componentsReset();
  nextQuestion();
}

function componentsReset() {
  selectedIngredients.clear();
  updateCup();
  // Reset all buttons
  document.querySelectorAll(".ingredient-btn").forEach(btn => btn.classList.remove("selected"));
}

function nextQuestion() {
  if (currentRound >= rounds) {
    drinkNameEl.textContent = "Game over!";
    submitBtn.disabled = true;
    resultEl.textContent = `Your final score: ${score} / ${rounds}`;
    return;
  }
  currentDrink = drinks[Math.floor(Math.random() * drinks.length)];
  drinkNameEl.textContent = `Drink: ${currentDrink}`;
  currentRound++;
  componentsReset();
  resultEl.textContent = "";
}

submitBtn.addEventListener("click", () => {
  if (selectedIngredients.size === 0) {
    resultEl.textContent = "Please select at least one ingredient.";
    return;
  }
  const userAnswer = normalizeList([...selectedIngredients]);
  const correctAnswer = normalizeList(recipes[currentDrink]);

  if (JSON.stringify(userAnswer) === JSON.stringify(correctAnswer)) {
    resultEl.textContent = "✅ Correct!";
    score++;
  } else {
    resultEl.innerHTML = `❌ Wrong.<br>Correct components: ${recipes[currentDrink].join(", ")}`;
  }
  scoreEl.textContent = `Score: ${score} / ${rounds}`;

  setTimeout(nextQuestion, 2500);
});

renderIngredients();
startGame();
</script>

</body>
</html>
